---
title: "Authentication & Security"
description: "Learn about authentication patterns, security considerations, and error handling for Bhindi agents."
icon: "shield"
---

<Card title="Agent Security & Authentication" icon="shield">
  Bhindi agents use a flexible authentication system where requirements depend
  on your agent's functionality. Understanding these patterns is crucial for
  building secure and reliable agents.
</Card>

## Authentication Flow

```mermaid
flowchart TD
    A[User Request] --> B{Tool Type?}
    B -->|Public Tool| C[No Auth Required]
    B -->|Private Tool| D[Auth Required]
    D --> E[API Key/OAuth]
    E --> F[Validate Credentials]
    F -->|Valid| G[Execute Tool]
    F -->|Invalid| H[Return Error]
    C --> G
    G --> I[Return Result]

    style A fill:#3498db,stroke:#2980b9,color:#fff
    style G fill:#2ecc71,stroke:#27ae60,color:#fff
    style H fill:#e74c3c,stroke:#c0392b,color:#fff
```

## Authentication Patterns

<Tabs>
  <Tab title="Public Tools">
    <Card title="No Authentication Required" icon="unlock">
      The `/tools` endpoint and simple utility tools don't require authentication.
    </Card>

    ### GET `/tools` Endpoint

    <Info>
      This endpoint is always public to allow Bhindi to discover your agent's capabilities.
    </Info>

    ```http
    GET /tools
    ```

    ### Public Utility Tools

    <Card title="Calculator Example" icon="calculator">
      Simple tools like calculators don't need authentication since they don't access sensitive data.
    </Card>

    ```http
    POST /tools/calculate
    Content-Type: application/json

    {
      "expression": "2 + 2 * 3"
    }
    ```

    <Note>
      Public tools are great for utilities, converters, formatters, and other non-sensitive operations.
    </Note>

  </Tab>

  <Tab title="Private Tools">
    <Card title="Authentication Required" icon="lock">
      Tools that integrate with external services or handle sensitive data require authentication.
    </Card>

    ### Standard Authentication

    <CardGroup cols={2}>
      <Card title="API Key" icon="key">
        For service-to-service authentication
      </Card>
      <Card title="OAuth Token" icon="user-shield">
        For user-specific access to external services
      </Card>
    </CardGroup>

    ```http
    POST /tools/sendMessage
    x-slack-api-key: your-api-key-here
    Authorization: Bearer user-oauth-token-here
    Content-Type: application/json

    {
      "channel": "#general",
      "message": "Hello from Bhindi!"
    }
    ```

    ### Custom Headers

    <Card title="Service-Specific Configuration" icon="list-ul">
      Use custom headers for agent-specific configuration like endpoints, project IDs, etc.
    </Card>

    ```http
    POST /tools/listDocuments
    x-appwrite-api-key: your-api-key-here
    x-appwrite-project-id: your-project-id-here
    x-appwrite-endpoint-url: your-endpoint-url-here
    Content-Type: application/json

    {
      "databaseId": "your-database-id-here",
      "collectionId": "your-collection-id-here",
      "query": "your-query-here"
    }
    ```

    <Tip>
      Use descriptive header names with your service prefix to avoid conflicts (e.g., `x-slack-`, `x-github-`).
    </Tip>

  </Tab>
</Tabs>

## Security Best Practices

<CardGroup cols={2}>
  <Card title="Input Validation" icon="shield">
    **Always validate and sanitize input**
    
    - Use validation libraries like Joi or Yup
    - Follow OWASP input validation guidelines
    - Prevent injection attacks and buffer overflows
    <br />
    **Resources:**
    - [OWASP Input Validation](https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html)
    - [NodeJS Security](https://nodejs.org/en/docs/guides/security)
  </Card>

<Card title="Data Protection" icon="user-lock">
  **Protect sensitive information** - Never log API keys or passwords - Encrypt
  sensitive data in transit and at rest - Follow GDPR and CCPA regulations.
  <br />
  **Resources:** - [OWASP Data
  Exposure](https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure)
  - [GDPR Compliance](https://gdpr.eu/compliance/)
</Card>

<Card title="Rate Limiting" icon="hive">
  **Prevent abuse and DoS attacks** - Implement per-IP or per-user limits - Use
  token bucket or leaky bucket algorithms - Return appropriate 429 status codes.
  <br />
  **Resources:**

- [Rate Limiting Algorithms](https://konghq.com/blog/how-to-design-a-scalable-rate-limiting-algorithm)
- [API Rate Limiting](https://cloud.google.com/armor/docs/rate-limiting-overview)
</Card>

<Card title="HTTPS Enforcement" icon="certificate">
    **Secure data in transit**
    <br />
    - HTTPS is mandatory for production
    - Use strong TLS configurations
    - Keep certificates up to date
    - Consider HSTS and certificate pinning
  </Card>
</CardGroup>

## Error Handling

### Standard Error Format

<Card title="Consistent Error Structure" icon="triangle-exclamation">
  Always use the `BaseErrorResponseDto` format for consistent error handling
  across all agents.
</Card>

```typescript
interface ErrorResponse {
  success: false;
  error: {
    message: string; // Human-readable error message
    code: string; // Machine-readable error code
    details: string; // Additional context or debugging info
  };
}
```

### Error Categories

<Tabs>
  <Tab title="Authentication Errors">
    <Card title="Auth-Related Errors" icon="lock">
      Handle authentication and authorization failures gracefully.
    </Card>

    ```typescript
    const AUTH_ERRORS = {
      MISSING_API_KEY: 'MISSING_API_KEY',
      INVALID_API_KEY: 'INVALID_API_KEY',
      MISSING_OAUTH_TOKEN: 'MISSING_OAUTH_TOKEN',
      INVALID_OAUTH_TOKEN: 'INVALID_OAUTH_TOKEN',
      TOKEN_EXPIRED: 'TOKEN_EXPIRED',
      INSUFFICIENT_PERMISSIONS: 'INSUFFICIENT_PERMISSIONS'
    };
    ```

    **Example Error Response:**
    ```json
    {
      "success": false,
      "error": {
        "message": "API key is required for this operation",
        "code": "MISSING_API_KEY",
        "details": "Please provide a valid API key in the x-api-key header"
      }
    }
    ```

  </Tab>

  <Tab title="Validation Errors">
    <Card title="Input Validation Errors" icon="shield-check">
      Handle invalid or malformed input parameters.
    </Card>

    ```typescript
    const VALIDATION_ERRORS = {
      INVALID_PARAMETERS: 'INVALID_PARAMETERS',
      MISSING_REQUIRED_FIELD: 'MISSING_REQUIRED_FIELD',
      INVALID_FORMAT: 'INVALID_FORMAT',
      VALUE_TOO_LONG: 'VALUE_TOO_LONG'
    };
    ```

    **Example Error Response:**
    ```json
    {
      "success": false,
      "error": {
        "message": "Required field 'channel' is missing",
        "code": "MISSING_REQUIRED_FIELD",
        "details": "The 'channel' parameter is required for sending messages"
      }
    }
    ```

  </Tab>

  <Tab title="Resource Errors">
    <Card title="Resource-Related Errors" icon="folder-open">
      Handle resource not found, conflicts, and availability issues.
    </Card>

    ```typescript
    const RESOURCE_ERRORS = {
      RESOURCE_NOT_FOUND: 'RESOURCE_NOT_FOUND',
      RESOURCE_ALREADY_EXISTS: 'RESOURCE_ALREADY_EXISTS',
      RESOURCE_UNAVAILABLE: 'RESOURCE_UNAVAILABLE'
    };
    ```

  </Tab>

  <Tab title="System Errors">
    <Card title="System-Level Errors" icon="server">
      Handle internal errors, timeouts, and service unavailability.
    </Card>

    ```typescript
    const SYSTEM_ERRORS = {
      INTERNAL_ERROR: 'INTERNAL_ERROR',
      SERVICE_UNAVAILABLE: 'SERVICE_UNAVAILABLE',
      TIMEOUT: 'TIMEOUT',
      RATE_LIMIT_EXCEEDED: 'RATE_LIMIT_EXCEEDED'
    };
    ```

  </Tab>
</Tabs>

## HTTP Status Codes

<Card title="Use Appropriate Status Codes" icon="list-ol">
  Match your response status codes to the type of error or success to help
  clients handle responses correctly.
</Card>

| Status Code | Usage                 | Example                    | Icon |
| ----------- | --------------------- | -------------------------- | ---- |
| **200**     | Success               | Tool executed successfully | ‚úÖ   |
| **400**     | Bad Request           | Invalid parameters         | ‚ùå   |
| **401**     | Unauthorized          | Missing or invalid API key | üîê   |
| **403**     | Forbidden             | Insufficient permissions   | üö´   |
| **404**     | Not Found             | Tool or resource not found | üîç   |
| **429**     | Too Many Requests     | Rate limit exceeded        | ‚è±Ô∏è   |
| **500**     | Internal Server Error | Unexpected server error    | ‚ö†Ô∏è   |

## Implementation Steps

<Steps>
  <Step title="Choose Authentication Strategy" icon="compass">
    **Determine what authentication your agent needs**
    
    - Public tools: No authentication required
    - Private tools: API keys, OAuth tokens, or custom headers
    - Consider user privacy and security requirements
    
    <Card title="Decision Matrix" icon="table">
      **Public tools**: Calculators, converters, formatters
      **Private tools**: External API integrations, user data access
    </Card>
  </Step>

<Step title="Implement Security Measures" icon="shield">
  **Build security into your agent from the start** - Input validation and
  sanitization - Rate limiting and abuse prevention - Secure credential handling
  - HTTPS enforcement
  <Warning>
    Never store or log sensitive credentials like API keys or tokens.
  </Warning>
</Step>

<Step title="Design Error Handling" icon="bug">
  **Create consistent error responses** - Use standard error format - Provide
  helpful error messages - Include appropriate HTTP status codes - Add debugging
  context when needed
  <Tip>
    Good error messages help users fix issues quickly and reduce support burden.
  </Tip>
</Step>

  <Step title="Test Security & Errors" icon="vial">
    **Validate your security implementation**
    
    - Test with invalid credentials
    - Verify rate limiting works
    - Check error message quality
    - Perform security audits
    
    <Card title="Security Checklist" icon="clipboard-check">
      ‚úÖ Input validation
      ‚úÖ Rate limiting
      ‚úÖ Error handling
      ‚úÖ HTTPS enforcement
      ‚úÖ Credential security
    </Card>
  </Step>
</Steps>

<Card title="Security Resources" icon="book">
  Building secure agents? Check out the [OWASP Security
  Guidelines](https://owasp.org/www-project-api-security/) and our [agent best
  practices](/agents/best-practices) for comprehensive security guidance.
</Card>
